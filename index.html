<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
	    <meta name="viewport" content="width=device-width,height=device-height" />
	    <meta http-equiv="X-UA-Compatible" content="IE=9;no-cache"/>
	    <meta name="apple-mobile-web-app-capable" content="yes">
	 	<link rel="stylesheet" href="style.css" type="text/css">
		<title>Dice Roller</title>
		<script src="res/jquery-1.9.1.js"></script>
		<script src="res/jquery-ui.js"></script>
		<script>
		$(document).ready(function() {
			$("#roll").click(function() {
				var start = new Date().getTime();
				if($("#audio").val() == 1) {
					document.getElementById('audioplayer').play();
				}
				var dice = $("#dice").val() * 1;
				for(var i = 1;i < dice + 1;i++) {
					document.getElementById('die' + i).style.marginLeft = Math.floor(Math.random() * 4) + 1 + '0%';
					$("#die" + i).effect("shake", {times: 10}, 2000);
				}
				var timer = setInterval(function() {
					var now = new Date().getTime();
					var n;
					for(var i = 1;i < dice + 1;i++) {
						n = Math.floor(Math.random() * 6) + 1;
						document.getElementById('die' + i).src = 'res/' + n + '.png';
					}
					if(now - start >= 2500) {
						window.clearInterval(timer);
						for(var i = 1;i < dice + 1;i++) {
							document.getElementById('die' + i).style.marginLeft = '0';
						}
					};
				}, 100);
			});
	
			$("#add").click(function() {
				if($("#dice").val() < 3) {
					var id = "die" + (($("#dice").val() * 1) + 1);
					document.getElementById(id).style.display = 'inline';
					$("#dice").val($("#dice").val() * 1 + 1);
					document.getElementById('remove').src = 'res/minus.png';
					if($("#dice").val() == 3) {
						document.getElementById('add').src = 'res/plus_gray.png';
					}
				}
			});
	
			$("#remove").click(function() {
				if($("#dice").val() > 1) {
					var id = "die" + (($("#dice").val() * 1));
					document.getElementById(id).style.display = 'none';
					$("#dice").val($("#dice").val() * 1 - 1);
					document.getElementById('add').src = 'res/plus.png';
					if($("#dice").val() == 1) {
						document.getElementById('remove').src = 'res/minus_gray.png';
					}
				}
			});
	
			$("#toggleaudio").click(function() {
				if($("#audio").val() == 1) {
					document.getElementById("toggleaudio").src = 'res/speaker_off.png';
					$("#audio").val(0);
				} else {
					document.getElementById("toggleaudio").src = 'res/speaker_on.png';
					$("#audio").val(1);
				}			                                            
			});
		});
		</script>
	</head>
	<body>
		<input type="hidden" value="1" id="dice" />
		<input type="hidden" value="1" id="audio" />
		<table class="content">
			<tr>
				<td class="content">
					<img id="die1" src="res/1.png" />
					<br />
					<img id="die2" src="res/1.png" style="display: none;" />
					<br />	
					<img id="die3" src="res/1.png" style="display: none;" />
				</td>
			</tr>
		</table>
		<div>
			<div class="buttons">
				<img src="res/refresh.png" id="roll" />&nbsp;
				<img src="res/speaker_on.png" id="toggleaudio" />&nbsp;
				<img src="res/plus.png" id="add" />&nbsp;
				<img src="res/minus_gray.png" id="remove" />
			</div>
		</div>
		<audio id="audioplayer">
			<source src="res/roll.mp3" type="audio/mp3"></source>
		</audio>
	</body>
</html>